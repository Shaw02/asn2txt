
	.186
	.model	tiny,stdcall


;****************************************************************
;*		外部宣言					*
;****************************************************************
include	lib_dos.inc


;****************************************************************
;*		コード						*
;****************************************************************
;---------------------------------------------------------------|
;		ファイル名の拡張子変更				|
;---------------------------------------------------------------|
;	●引数							|
;		*cFilename	拡張子付きファイル名		|
;		*cExt		変更後の拡張子(3文字で)		|
;	●返り値						|
;		cFilename	拡張子変更後　ファイル名	|
;---------------------------------------------------------------|
.code
Change_Filename_Ext	proc	near	uses ax cx si di ds es,
		strName	:far ptr byte,
		strExt	:far ptr byte

	les	di,strName
	lds	si,strExt

	mov	al,'.'			;
	mov	cx,085h			;
	repnz	scasb			;拡張子を捜す

	mov	cx,3			;
	rep	movsb			;
	mov	al,0			;
	stosb				;
	mov	al,24h			;
	stosb				;書き換える

	ret
Change_Filename_Ext	endp
;****************************************************************
	end
